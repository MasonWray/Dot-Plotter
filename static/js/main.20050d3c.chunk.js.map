{"version":3,"sources":["redux/actions.js","util/RGBtoCMYK.js","redux/reducers/Layers.js","redux/reducers/FileSelector.js","redux/reducers/OutputSettings.js","redux/reducers/Output.js","redux/reducer.js","redux/store.js","components/FileSelector.jsx","util/renderRasterLayer.js","components/Layers.jsx","util/useElementSize.js","components/Preview.jsx","workers/jobs.js","workers/Worker.js","util/renderVectorLayer.js","components/OutputSettings.jsx","components/App.jsx","index.jsx"],"names":["ACTIONS","TOGGLE_RASTER_VISIBILITY","TOGGLE_VECTOR_VISIBILITY","SET_LAYER_RASTER","SET_LAYER_VECTOR","SET_LAYER_GCODE","SET_VECTOR_REF","SET_SOURCE_IMAGE","SET_OUTPUT_SIZE","SET_SOURCE_SIZE","SET_OUTPUT_TOOL_DIAMETER","SET_FEEDRATE_TRAVEL","SET_FEEDRATE_PLUNGE","SET_HEIGHT_TRAVEL","SET_HEIGHT_PLUNGE","RGBtoCMYK","r","g","b","R","G","B","K","Math","max","C","M","Y","initialState","name","color","mapper","convert","raster_visible","raster","undefined","vector_visible","vector","vector_ref","Layers","state","action","type","map","layer","index","payload","id","ref","sourceImage","FileSelector","needsUpdate","sourceWidth","sourceHeight","stockWidth","stockHeight","toolDiameter","feedrateTravel","feedratePlunge","heightTravel","heightPlunge","OutputSettings","width","height","package","Output","SET_DOWNLOAD_PACKAGE","reducer","combineReducers","enableReduxDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","store","createStore","dispatch","useDispatch","className","onChange","e","target","files","fr","FileReader","img","Image","onload","src","result","readAsDataURL","a","source","canvas","current","context","getContext","drawImage","imgd","getImageData","data","pix","i","n","length","putImageData","image","console","log","toDataURL","renderRasterLayer","Layer","props","rasterLayerRef","useRef","vectorPreviewRef","useSelector","useEffect","onClick","visIcon","hidden","visible","xmlns","fill","viewBox","d","layers","useElementSize","eRef","useState","size","setSize","useLayoutEffect","updateSize","getBoundingClientRect","addEventListener","removeEventListener","Preview","previewRef","canvasRef","settings","round","forEach","save","scale","restore","JOBS","ARCHIVE","RASTER","VECTOR","Worker_fn","Worker","renderVectorLayer","Promise","resolve","reject","worker","onmessage","gcode","postMessage","job","download","pkg","setPkg","disabled","value","newWidth","newHeight","handleWidthChange","handleHeightChange","step","then","push","fillRule","href","click","App","version","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.20050d3c.chunk.js","sourcesContent":["const ACTIONS = {\r\n    TOGGLE_RASTER_VISIBILITY: 'TOGGLE_RASTER_VISIBILITY',\r\n    TOGGLE_VECTOR_VISIBILITY: 'TOGGLE_VECTOR_VISIBILITY',\r\n    SET_LAYER_RASTER: 'SET_LAYER_RASTER',\r\n    SET_LAYER_VECTOR: 'SET_LAYER_VECTOR',\r\n    SET_LAYER_GCODE: 'SET_LAYER_GCODE',\r\n\r\n    SET_VECTOR_REF: 'SET_VECTOR_REF',\r\n\r\n    SET_SOURCE_IMAGE: 'SET_SOURCE_IMAGE',\r\n\r\n    SET_OUTPUT_SIZE: 'SET_OUTPUT_SIZE',\r\n    SET_SOURCE_SIZE: 'SET_SOURCE_SIZE',\r\n    SET_OUTPUT_TOOL_DIAMETER: 'SET_OUTPUT_TOOL_DIAMETER',\r\n    SET_FEEDRATE_TRAVEL: 'SET_FEEDRATE_TRAVEL',\r\n    SET_FEEDRATE_PLUNGE: 'SET_FEEDRATE_PLUNGE',\r\n    SET_HEIGHT_TRAVEL: 'SET_HEIGHT_TRAVEL',\r\n    SET_HEIGHT_PLUNGE: 'SET_HEIGHT_PLUNGE',\r\n}\r\n\r\nexport default ACTIONS;","const RGBtoCMYK = function (r, g, b) {\r\n    var R = r / 255;\r\n    var G = g / 255;\r\n    var B = b / 255;\r\n\r\n    var K = 1 - Math.max(R, G, B);\r\n    var C = (1 - R - K) / (1 - K);\r\n    var M = (1 - G - K) / (1 - K);\r\n    var Y = (1 - B - K) / (1 - K);\r\n\r\n    return { C: C, M: M, Y: Y, K: K };\r\n}\r\n\r\nexport default RGBtoCMYK;","import ACTIONS from '../actions';\r\nimport convert from '../../util/RGBtoCMYK';\r\n\r\nconst initialState = [\r\n    {\r\n        name: \"Cyan\",\r\n        color: { r: 0, g: 255, b: 255 },\r\n        mapper: ((r, g, b) => { return convert(r, g, b).C }),\r\n        raster_visible: true,\r\n        raster: undefined,\r\n        vector_visible: false,\r\n        vector: undefined,\r\n        vector_ref: undefined,\r\n    },\r\n    {\r\n        name: \"Magenta\",\r\n        color: { r: 255, g: 0, b: 255 },\r\n        mapper: ((r, g, b) => { return convert(r, g, b).M }),\r\n        raster_visible: true,\r\n        raster: undefined,\r\n        vector_visible: false,\r\n        vector: undefined,\r\n        vector_ref: undefined,\r\n    },\r\n    {\r\n        name: \"Yellow\",\r\n        color: { r: 255, g: 255, b: 0 },\r\n        mapper: ((r, g, b) => { return convert(r, g, b).Y }),\r\n        raster_visible: true,\r\n        raster: undefined,\r\n        vector_visible: false,\r\n        vector: undefined,\r\n        vector_ref: undefined,\r\n    },\r\n    {\r\n        name: \"Black\",\r\n        color: { r: 0, g: 0, b: 0 },\r\n        mapper: ((r, g, b) => { return convert(r, g, b).K }),\r\n        raster_visible: true,\r\n        raster: undefined,\r\n        vector_visible: false,\r\n        vector: undefined,\r\n        vector_ref: undefined,\r\n    }\r\n];\r\n\r\nconst Layers = function (state = initialState, action) {\r\n    switch (action.type) {\r\n        case ACTIONS.TOGGLE_RASTER_VISIBILITY: {\r\n            return state.map((layer, index) => {\r\n                if (index !== action.payload.id) {\r\n                    return layer\r\n                }\r\n                return {\r\n                    ...layer,\r\n                    raster_visible: !layer.raster_visible,\r\n                }\r\n            })\r\n        }\r\n\r\n        case ACTIONS.SET_LAYER_RASTER: {\r\n            return state.map((layer, index) => {\r\n                if (index !== action.payload.id) {\r\n                    return layer\r\n                }\r\n                return {\r\n                    ...layer,\r\n                    raster: action.payload.raster,\r\n                }\r\n            })\r\n        }\r\n\r\n        case ACTIONS.TOGGLE_VECTOR_VISIBILITY: {\r\n            return state.map((layer, index) => {\r\n                if (index !== action.payload.id) {\r\n                    return layer\r\n                }\r\n                return {\r\n                    ...layer,\r\n                    vector_visible: !layer.vector_visible,\r\n                }\r\n            })\r\n        }\r\n\r\n        case ACTIONS.SET_LAYER_VECTOR: {\r\n            return state.map((layer, index) => {\r\n                if (index !== action.payload.id) {\r\n                    return layer\r\n                }\r\n                return {\r\n                    ...layer,\r\n                    vector: action.payload.vector,\r\n                }\r\n            })\r\n        }\r\n\r\n        case ACTIONS.SET_VECTOR_REF: {\r\n            return state.map((layer, index) => {\r\n                if (index !== action.payload.id) {\r\n                    return layer\r\n                }\r\n                return {\r\n                    ...layer,\r\n                    vector_ref: action.payload.ref,\r\n                }\r\n            })\r\n        }\r\n\r\n        default: {\r\n            return state;\r\n        }\r\n    }\r\n}\r\n\r\nexport default Layers;","import ACTIONS from '../actions';\r\n\r\nconst initialState = { sourceImage: undefined };\r\n\r\nconst FileSelector = function (state = initialState, action) {\r\n    switch (action.type) {\r\n        case ACTIONS.SET_SOURCE_IMAGE:\r\n            return {\r\n                ...state,\r\n                sourceImage: action.payload,\r\n            };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default FileSelector;","import ACTIONS from '../actions';\r\n\r\nconst initialState = {\r\n    needsUpdate: true,\r\n    sourceWidth: 0,\r\n    sourceHeight: 0,\r\n    stockWidth: 0,\r\n    stockHeight: 0,\r\n    toolDiameter: 0.4,\r\n    feedrateTravel: 2000,\r\n    feedratePlunge: 1200,\r\n    heightTravel: 3,\r\n    heightPlunge: 0.2,\r\n}\r\n\r\nfunction OutputSettings(state = initialState, action) {\r\n    switch (action.type) {\r\n        case ACTIONS.SET_OUTPUT_SIZE: {\r\n            return {\r\n                ...state,\r\n                stockWidth: action.payload.width,\r\n                stockHeight: action.payload.height,\r\n            }\r\n        }\r\n\r\n        case ACTIONS.SET_SOURCE_SIZE:\r\n            return {\r\n                ...state,\r\n                stockWidth: action.payload.width,\r\n                stockHeight: action.payload.height,\r\n                sourceWidth: action.payload.width,\r\n                sourceHeight: action.payload.height,\r\n            };\r\n\r\n        case ACTIONS.SET_OUTPUT_TOOL_DIAMETER: {\r\n            return {\r\n                ...state,\r\n                toolDiameter: action.payload,\r\n            }\r\n        }\r\n\r\n        case ACTIONS.SET_FEEDRATE_TRAVEL: {\r\n            return {\r\n                ...state,\r\n                feedrateTravel: action.payload,\r\n            }\r\n        }\r\n\r\n        case ACTIONS.SET_FEEDRATE_PLUNGE: {\r\n            return {\r\n                ...state,\r\n                feedratePlunge: action.payload,\r\n            }\r\n        }\r\n\r\n        case ACTIONS.SET_HEIGHT_TRAVEL: {\r\n            return {\r\n                ...state,\r\n                heightTravel: action.payload,\r\n            }\r\n        }\r\n\r\n        case ACTIONS.SET_HEIGHT_PLUNGE: {\r\n            return {\r\n                ...state,\r\n                heightPlunge: action.payload,\r\n            }\r\n        }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default OutputSettings;","import ACTIONS from '../actions';\r\n\r\nconst initialState = {\r\n    package: undefined\r\n};\r\n\r\nfunction Output(state = initialState, action) {\r\n    switch (action.type) {\r\n        case ACTIONS.SET_DOWNLOAD_PACKAGE:\r\n            return {\r\n                ...state,\r\n                package: action.payload,\r\n            }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default Output;","import { combineReducers } from 'redux';\r\n\r\nimport Layers from './reducers/Layers';\r\nimport FileSelector from './reducers/FileSelector';\r\nimport OutputSettings from './reducers/OutputSettings';\r\nimport Output from './reducers/Output';\r\n\r\nconst reducer = combineReducers({ Layers, FileSelector, OutputSettings, Output })\r\n\r\nexport default reducer;","import { createStore } from 'redux';\r\nimport reducer from './reducer';\r\n\r\nconst enableReduxDevTools = window.__REDUX_DEVTOOLS_EXTENSION__?.();\r\nconst store = createStore(reducer, enableReduxDevTools);\r\n\r\nexport default store;","import React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\n\r\nimport ACTIONS from '../redux/actions';\r\n\r\nfunction FileSelector() {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleFileChange = function (e) {\r\n        if (e.target.files[0]) {\r\n            var fr = new FileReader();\r\n            var img = new Image();\r\n            fr.onload = () => {\r\n                img.src = fr.result;\r\n                img.onload = () => {\r\n                    dispatch({ type: ACTIONS.SET_SOURCE_IMAGE, payload: img })\r\n                    dispatch({ type: ACTIONS.SET_SOURCE_SIZE, payload: { width: img.width, height: img.height } })\r\n                }\r\n            }\r\n            fr.readAsDataURL(e.target.files[0])\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"card\">\r\n            <div className=\"card-header\">File Selector</div>\r\n            <div className=\"card-body\">\r\n                <div className=\"form-group\">\r\n                    <input\r\n                        type=\"file\"\r\n                        className=\"form-control-file\"\r\n                        onChange={handleFileChange} />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default FileSelector;","import ACTIONS from '../redux/actions';\r\n\r\nasync function renderRasterLayer(layer, ref, dispatch) {\r\n    if (layer.source) {\r\n        // Clear canvas and set it to the size of the source image\r\n        var canvas = ref.current;\r\n        var context = canvas.getContext(\"2d\");\r\n        canvas.height = layer.source.height;\r\n        canvas.width = layer.source.width;\r\n        context.drawImage(layer.source, 0, 0)\r\n\r\n        // Get ImageData for per-pixel editing\r\n        var imgd = context.getImageData(0, 0, layer.source.width, layer.source.height);\r\n        var src = [...imgd.data];\r\n        var pix = imgd.data;\r\n\r\n        // Update pixels with mapper function\r\n        for (var i = 0, n = pix.length; i < n; i += 4) {\r\n            pix[i + 0] = layer.color.r; // red\r\n            pix[i + 1] = layer.color.g; // green\r\n            pix[i + 2] = layer.color.b; // blue\r\n            pix[i + 3] = 255 * layer.mapper(src[i + 0], src[i + 1], src[i + 2]); // alpha\r\n        }\r\n        context.putImageData(imgd, 0, 0);\r\n\r\n        // Update layer data in redux store\r\n        var image = new Image();\r\n        image.onload = () => {\r\n            console.log(\"Rendered Raster: \", layer.name)\r\n            dispatch({ type: ACTIONS.SET_LAYER_RASTER, payload: { id: layer.id, raster: image } })\r\n        }\r\n        image.src = canvas.toDataURL();\r\n    }\r\n}\r\n\r\nexport default renderRasterLayer;","import React, { useRef, useEffect } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport renderRasterLayer from '../util/renderRasterLayer';\r\nimport ACTIONS from '../redux/actions';\r\n\r\nfunction Layers(props) {\r\n    const layers = useSelector((state) => state.Layers.map((layer, index) => { return index; }))\r\n    return (\r\n        <div className=\"card\">\r\n            <div className=\"card-header\">\r\n                {\"Layers\"}\r\n            </div>\r\n\r\n            <ul className=\"list-group list-group-flush\">\r\n                {layers.map((layer, index) => {\r\n                    return (\r\n                        <Layer\r\n                            key={index}\r\n                            id={index}\r\n                        />\r\n                    )\r\n                })}\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction Layer(props) {\r\n    const dispatch = useDispatch();\r\n    const rasterLayerRef = useRef();\r\n    const vectorPreviewRef = useRef();\r\n    const layer = useSelector((state) => state.Layers[props.id]);\r\n    const source = useSelector((state) => state.FileSelector.sourceImage);\r\n\r\n    useEffect(() => {\r\n        if (!layer.vector_ref) {\r\n            dispatch({ type: ACTIONS.SET_VECTOR_REF, payload: { id: props.id, ref: vectorPreviewRef } })\r\n        }\r\n    })\r\n\r\n    useEffect(() => {\r\n        const data = {\r\n            source: source,\r\n            name: layer.name,\r\n            id: props.id,\r\n            color: layer.color,\r\n            mapper: layer.mapper\r\n        }\r\n        renderRasterLayer(data, rasterLayerRef, dispatch)\r\n    }, [source, layer.name, props.id, layer.color, layer.mapper, dispatch])\r\n\r\n    return (\r\n        <li className=\"list-group-item\">\r\n            <div className=\"row\">\r\n                <div className=\"col\">\r\n                    <label>{layer.name}</label>\r\n                </div>\r\n                <div className=\"col\">\r\n                    <span onClick={() => { dispatch({ type: ACTIONS.TOGGLE_RASTER_VISIBILITY, payload: { id: props.id } }) }}>\r\n                        {visIcon(layer.raster_visible)}\r\n                    </span>\r\n                </div>\r\n                <div className=\"col\">\r\n                    <span onClick={() => { dispatch({ type: ACTIONS.TOGGLE_VECTOR_VISIBILITY, payload: { id: props.id } }) }}>\r\n                        {visIcon(layer.vector_visible)}\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <canvas ref={rasterLayerRef} hidden={true} /><canvas ref={vectorPreviewRef} hidden={true} />\r\n        </li>\r\n    )\r\n}\r\n\r\nfunction visIcon(visible) {\r\n    if (visible) {\r\n        return (\r\n            <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                width=\"16\" height=\"16\"\r\n                fill=\"currentColor\"\r\n                className=\"bi bi-eye-fill\"\r\n                viewBox=\"0 0 16 16\">\r\n                <path d=\"M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z\" />\r\n                <path d=\"M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z\" />\r\n            </svg>\r\n        )\r\n    }\r\n    else {\r\n        return (\r\n            <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                width=\"16\"\r\n                height=\"16\"\r\n                fill=\"currentColor\"\r\n                className=\"bi bi-eye-slash-fill\"\r\n                viewBox=\"0 0 16 16\">\r\n                <path d=\"M10.79 12.912l-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7.027 7.027 0 0 0 2.79-.588zM5.21 3.088A7.028 7.028 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474L5.21 3.088z\" />\r\n                <path d=\"M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829l-2.83-2.829zm4.95.708l-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6l-12-12 .708-.708 12 12-.708.707z\" />\r\n            </svg>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Layers;","import { useState, useLayoutEffect } from 'react';\r\n\r\n// Get current size of given element when it is resized\r\nfunction useElementSize(eRef) {\r\n    const [size, setSize] = useState([0, 0]);\r\n    useLayoutEffect(() => {\r\n        function updateSize() {\r\n            if (eRef) {\r\n                setSize([eRef.current.getBoundingClientRect().width, eRef.current.getBoundingClientRect().height]);\r\n            }\r\n        }\r\n        window.addEventListener('resize', updateSize);\r\n        updateSize();\r\n        return () => window.removeEventListener('resize', updateSize);\r\n    }, [eRef]);\r\n    return size;\r\n}\r\n\r\nexport default useElementSize;","import React, { useRef, useEffect } from 'react';\r\nimport { useSelector } from 'react-redux';\r\n\r\nimport useElementSize from '../util/useElementSize';\r\n\r\nfunction Preview() {\r\n    const previewRef = useRef();\r\n    const canvasRef = useRef();\r\n\r\n    const layers = useSelector((state) => state.Layers);\r\n    const sourceImage = useSelector((state) => state.FileSelector.sourceImage);\r\n    const settings = useSelector((state) => state.OutputSettings);\r\n\r\n    // Depend on size of preview card\r\n    const size = useElementSize(previewRef);\r\n\r\n    useEffect(() => {\r\n        var canvas = canvasRef.current;\r\n        var context = canvas.getContext(\"2d\");\r\n        if (sourceImage) {\r\n            // Set canvas size based on preview window width and source size\r\n            canvas.width = Math.round(previewRef.current.getBoundingClientRect().width - 20);\r\n            canvas.height = Math.round(canvas.width * settings.sourceHeight / settings.sourceWidth);\r\n\r\n            // Draw raster previews\r\n            layers.forEach((layer) => {\r\n                if (layer.raster && layer.raster_visible) {\r\n                    context.save()\r\n                    context.scale(canvas.width / layer.raster.width, canvas.height / layer.raster.height)\r\n                    context.drawImage(layer.raster, 0, 0);\r\n                    context.restore()\r\n                }\r\n            })\r\n\r\n            // Draw vector Layers\r\n            layers.forEach((layer) => {\r\n                if (layer.vector && layer.vector_visible) {\r\n                    context.save()\r\n                    context.scale(canvas.width / layer.vector.width, canvas.height / layer.vector.height)\r\n                    context.drawImage(layer.vector, 0, 0);\r\n                    context.restore()\r\n                }\r\n            })\r\n        }\r\n    }, [settings.sourceWidth, settings.sourceHeight, sourceImage, layers, size])\r\n\r\n    return (\r\n        <div className=\"card\" ref={previewRef}>\r\n            <div className=\"card-header\">\r\n                {\"Preview\"}\r\n            </div>\r\n            <div className=\"card-body d-flex justify-content-center\">\r\n                <canvas ref={canvasRef} ></canvas>\r\n            </div>\r\n        </div >\r\n    )\r\n}\r\n\r\nexport default Preview;","const JOBS = {\r\n    ARCHIVE: 'ARCHIVE',\r\n    RASTER: 'RASTER',\r\n    VECTOR: 'VECTOR',\r\n}\r\n\r\nexport default JOBS;","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/Worker.42e0c0a9.worker.js\");\n}\n","import ACTIONS from '../redux/actions';\r\nimport JOBS from '../workers/jobs';\r\n\r\n/* eslint-disable import/no-webpack-loader-syntax */\r\nimport Worker from 'worker-loader!../workers/Worker';\r\n\r\nfunction renderVectorLayer(layer, ref, dispatch) {\r\n    return new Promise((resolve, reject) => {\r\n        if (layer.raster) {\r\n            // Draw raster layer to canvas\r\n            var canvas = ref.current;\r\n            var context = canvas.getContext(\"2d\");\r\n            canvas.width = Math.round(layer.settings.stockWidth / layer.settings.toolDiameter);\r\n            canvas.height = Math.round(layer.settings.stockHeight / layer.settings.toolDiameter);\r\n            context.scale(canvas.width / layer.settings.sourceWidth, canvas.height / layer.settings.sourceHeight)\r\n            context.drawImage(layer.raster, 0, 0);\r\n\r\n            // Get pixel data\r\n            var imgd = context.getImageData(0, 0, canvas.width, canvas.height);\r\n            var pix = imgd.data;\r\n\r\n            const worker = new Worker()\r\n\r\n            // Receive rendering result from worker\r\n            worker.onmessage = (e) => {\r\n                var image = new Image();\r\n                image.onload = () => {\r\n                    dispatch({ type: ACTIONS.SET_LAYER_VECTOR, payload: { id: layer.id, vector: image } })\r\n                    resolve({\r\n                        name: e.data.name,\r\n                        // image: image,\r\n                        gcode: e.data.gcode\r\n                    });\r\n                }\r\n                image.src = e.data.image;\r\n            }\r\n\r\n            // Send rendering task to web worker\r\n            worker.postMessage({\r\n                job: JOBS.VECTOR,\r\n                pix: pix,\r\n                settings: {\r\n                    heightTravel: layer.settings.heightTravel,\r\n                    feedrateTravel: layer.settings.feedrateTravel,\r\n                    heightPlunge: layer.settings.heightPlunge,\r\n                    feedratePlunge: layer.settings.feedratePlunge,\r\n                    width: canvas.width,\r\n                    toolDiameter: layer.settings.toolDiameter,\r\n                    color: layer.color,\r\n                    stockHeight: layer.settings.stockHeight,\r\n                    stockWidth: layer.settings.stockWidth,\r\n                    name: layer.name\r\n                }\r\n            })\r\n        }\r\n    })\r\n}\r\n\r\nexport default renderVectorLayer;","import React, { useRef, useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport renderVectorLayer from '../util/renderVectorLayer';\r\nimport ACTIONS from '../redux/actions';\r\nimport JOBS from '../workers/jobs';\r\n\r\n/* eslint-disable import/no-webpack-loader-syntax */\r\nimport Worker from 'worker-loader!../workers/Worker';\r\n\r\nfunction OutputSettings(props) {\r\n    const settings = useSelector((state) => state.OutputSettings);\r\n    const layers = useSelector((state) => state.Layers);\r\n    const download = useRef();\r\n    const [pkg, setPkg] = useState();\r\n    const dispatch = useDispatch();\r\n\r\n    function handleRefresh() {\r\n        var gcode = [];\r\n\r\n        // Render each layer\r\n        layers.forEach((layer, index) => {\r\n            const data = {\r\n                raster: layer.raster,\r\n                name: layer.name,\r\n                color: layer.color,\r\n                id: index,\r\n                settings: settings\r\n            }\r\n            renderVectorLayer(data, layer.vector_ref, dispatch)\r\n                .then((result) => {\r\n                    // Save result\r\n                    gcode.push({ name: result.name, gcode: result.gcode })\r\n\r\n                    // Package gcode files when processing is complete\r\n                    if (gcode.length === layers.length) {\r\n\r\n                        const worker = new Worker();\r\n\r\n                        // Receive archive result from worker\r\n                        worker.onmessage = (e) => {\r\n                            setPkg(e.data);\r\n                            console.log(\"Archive Finished\")\r\n                        }\r\n\r\n                        // Send archive job to web worker\r\n                        worker.postMessage({\r\n                            job: JOBS.ARCHIVE,\r\n                            gcode: gcode\r\n                        })\r\n                    }\r\n                })\r\n        })\r\n    }\r\n\r\n    function handleDownload() {\r\n        download.current.click();\r\n    }\r\n\r\n    function handleWidthChange(e) {\r\n        var newWidth = Math.round(e.target.value < 1 ? 1 : e.target.value * 1);\r\n        var newHeight = Math.round(newWidth * settings.sourceHeight / settings.sourceWidth);\r\n        dispatch({ type: ACTIONS.SET_OUTPUT_SIZE, payload: { width: newWidth, height: newHeight } })\r\n    }\r\n\r\n    function handleHeightChange(e) {\r\n        var newHeight = Math.round(e.target.value < 1 ? 1 : e.target.value * 1);\r\n        var newWidth = Math.round(newHeight * settings.sourceWidth / settings.sourceHeight);\r\n        dispatch({ type: ACTIONS.SET_OUTPUT_SIZE, payload: { width: newWidth, height: newHeight } })\r\n    }\r\n\r\n    return (\r\n        <div className=\"card\">\r\n            <div className=\"card-header\">Output Settings</div>\r\n            <ul className=\"list-group list-group-flush\">\r\n                <li className=\"list-group-item\">\r\n                    <div className=\"row mb-2\">\r\n                        <div className=\"col\">\r\n                            <label className=\"form-label\">Stock Width (mm)</label>\r\n                        </div>\r\n                        <div className=\"col\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"form-control\"\r\n                                disabled={!(settings.sourceWidth > 0)}\r\n                                value={settings.stockWidth}\r\n                                onChange={(e) => { handleWidthChange(e) }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                        <div className=\"col\">\r\n                            <label className=\"form-label\">Stock Height (mm)</label>\r\n                        </div>\r\n                        <div className=\"col\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"form-control\"\r\n                                disabled={!(settings.sourceHeight > 0)}\r\n                                value={settings.stockHeight}\r\n                                onChange={(e) => { handleHeightChange(e) }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n                <li className=\"list-group-item\">\r\n                    <div className=\"row\">\r\n                        <div className=\"col\">\r\n                            <label className=\"form-label\">Tool Diameter (mm)</label>\r\n                        </div>\r\n                        <div className=\"col\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"form-control\"\r\n                                step=\"0.1\"\r\n                                value={settings.toolDiameter}\r\n                                onChange={(e) => { dispatch({ type: ACTIONS.SET_OUTPUT_TOOL_DIAMETER, payload: e.target.value * 1 }) }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n                <li className=\"list-group-item\">\r\n                    <div className=\"row mb-2\">\r\n                        <div className=\"col\">\r\n                            <label className=\"form-label\">Travel Feedrate (mm/s)</label>\r\n                        </div>\r\n                        <div className=\"col\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"form-control\"\r\n                                step=\"50\"\r\n                                value={settings.feedrateTravel}\r\n                                onChange={(e) => { dispatch({ type: ACTIONS.SET_FEEDRATE_TRAVEL, payload: e.target.value * 1 }) }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                        <div className=\"col\">\r\n                            <label className=\"form-label\">Plunge Feedrate (mm/s)</label>\r\n                        </div>\r\n                        <div className=\"col\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"form-control\"\r\n                                step=\"50\"\r\n                                value={settings.feedratePlunge}\r\n                                onChange={(e) => { dispatch({ type: ACTIONS.SET_FEEDRATE_PLUNGE, payload: e.target.value * 1 }) }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n                <li className=\"list-group-item\">\r\n                    <div className=\"row mb-2\">\r\n                        <div className=\"col\">\r\n                            <label className=\"form-label\">Travel Height (mm)</label>\r\n                        </div>\r\n                        <div className=\"col\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"form-control\"\r\n                                step=\"0.1\"\r\n                                value={settings.heightTravel}\r\n                                onChange={(e) => dispatch({ type: ACTIONS.SET_HEIGHT_TRAVEL, payload: e.target.value * 1 })}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                        <div className=\"col\">\r\n                            <label className=\"form-label\">Plunge Height (mm)</label>\r\n                        </div>\r\n                        <div className=\"col\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"form-control\"\r\n                                step=\"0.1\"\r\n                                value={settings.heightPlunge}\r\n                                onChange={(e) => dispatch({ type: ACTIONS.SET_HEIGHT_PLUNGE, payload: e.target.value * 1 })}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n                <li className=\"list-group-item\">\r\n                    <div className=\"row\">\r\n                        <div className=\"col mx-4\">\r\n                            <button className=\"btn btn-primary w-100\" onClick={handleRefresh}>\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" className=\"bi bi-arrow-repeat\" viewBox=\"0 0 16 16\">\r\n                                    <path d=\"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z\" />\r\n                                    <path fillRule=\"evenodd\" d=\"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z\" />\r\n                                </svg>\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"col mx-4\">\r\n                            <a\r\n                                hidden={true}\r\n                                download={\"output.zip\"}\r\n                                ref={download}\r\n                                href={pkg}\r\n                            >Download GCODE</a>\r\n                            <button className=\"btn btn-primary w-100\" disabled={!pkg} onClick={handleDownload}>\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" className=\"bi bi-arrow-bar-down\" viewBox=\"0 0 16 16\">\r\n                                    <path fillRule=\"evenodd\" d=\"M1 3.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5zM8 6a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 .708-.708L7.5 12.293V6.5A.5.5 0 0 1 8 6z\" />\r\n                                </svg>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default OutputSettings;","import FileSelector from './FileSelector';\r\nimport Layers from './Layers';\r\nimport Preview from './Preview';\r\nimport OutputSettings from './OutputSettings';\r\n\r\nimport pkg from '../../package.json';\r\n\r\nfunction App() {\r\n    return (\r\n        <div>\r\n            <nav className=\"navbar navbar-expand-lg navbar-light bg-light\">\r\n                <div className=\"container-fluid\">\r\n                    <div className=\"navbar-brand\">Dot Plotter</div>\r\n                    <div className=\"d-flex\">\r\n                        <div className=\"nav-item\">\r\n                            <div className=\"nav-link btn-group\">\r\n                                <button className=\"btn btn-outline-secondary btn-sm\" disabled={true}>{pkg.version}</button>\r\n                                <a href=\"https://github.com/MasonWray/Dot-Plotter\" className=\"btn btn-outline-secondary btn-sm\"> View on GitHub</a>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div >\r\n            </nav >\r\n            <div className=\"container-fluid\">\r\n                <div className=\"row\">\r\n                    {/* Left Sidebar */}\r\n                    <div className=\"col-sm-3\">\r\n                        <FileSelector />\r\n                        <Layers />\r\n                    </div>\r\n                    {/* Preview Area */}\r\n                    <div className=\"col-sm-6\">\r\n                        <Preview />\r\n                    </div>\r\n                    {/* Right Sidebar */}\r\n                    <div className=\"col-sm-3\">\r\n                        <OutputSettings />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport { Provider } from 'react-redux';\r\nimport store from './redux/store';\r\n\r\nimport App from './components/App';\r\n\r\nimport '../node_modules/bootstrap/dist/css/bootstrap.css';\r\nimport 'bootstrap/dist/js/bootstrap.bundle';\r\nimport './styles.css';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}